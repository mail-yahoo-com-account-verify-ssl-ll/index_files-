
(function(win, input){

	function base64_decode(s){
		// for modern browsers
		// TODO: test the worst case (i.e. the custom code) if we are requesting this with phantomJS for testing
		if( win.atob ) return win.atob(s);
		// for IE and some mobile ones
		var out = "",
			chr1, chr2, chr3,
			enc1, enc2, enc3, enc4,
			i,len=s.length, iO='indexOf',cA='charAt', fCC=String.fromCharCode,
			lut = "ABCDEFGHIJKLMNOP" +
			      "QRSTUVWXYZabcdef" +
			      "ghijklmnopqrstuv" +
			      "wxyz0123456789+/" +
			      "=";
		for(i=0;i<len;){
			// get the encoded bytes
			enc1 = lut[iO](s[cA](i++));
			enc2 = lut[iO](s[cA](i++));
			enc3 = lut[iO](s[cA](i++));
			enc4 = lut[iO](s[cA](i++));
			// turn them into chars
			chr1 = (enc1 << 2) | (enc2 >> 4);
			chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
			chr3 = ((enc3 & 3) << 6) | enc4;
			out += fCC(chr1);
			if (enc3 != 64) {
				out += fCC(chr2);
			}
			if (enc4 != 64) {
				out += fCC(chr3);
			}
		}
		return out;
	}
	/**
	 * Load a script in HEAD
	 *
	 * pass either uri or inner. one will set the SRC the other the .text
	 */
	function loadScript(uri, inner, sf) {
		var h = document.getElementsByTagName('head')[0] || document.documentElement,
			s = document.createElement('script');
		if( !sf ){
			s.type = 'text/javascript';
		}else{
			s.type = 'text/x-safeframe';
		}
		if( inner ){
			s.text = inner;
		}else{
			s.src = uri;
			s.crossorigin = 'anonymous';
		}
		return h.appendChild(s);
	}

	/* TODO: pass input as plain JSON, not a string... and then assign it to
	 * win.DARLA_CONFIG=input;
	 * and call a new public method that will parse the positions list (currently inline-code in boot.js:_get_tags()
	*/
	loadScript( false, base64_decode(input), true );
	loadScript( "https://s.yimg.com/rq/darla/boot.js", false, false);

}(window, "eyJwb3NpdGlvbnMiOlt7ImlkIjoiUklDSCIsImh0bWwiOiI8c2NyaXB0IHR5cGU9J3RleHRcL2phdmFzY3JpcHQnPmRvY3VtZW50LndyaXRlKCc8YSBocmVmPVwiaHR0cHM6XC9cL2FzLnkuYXR3b2xhLmNvbVwvP2FkbGlua3w1MTEzLjF8NTA0MzAzNXwwfDB8QWRJZD0tNDA7Qm5JZD0wO2l0aW1lPTIxOTE1MzA5MztrdnNlY3VyZSUyRGRhcmxhPTMlMkQxMSUyRDElN0N5c2QlN0MyO2t2bW49eTk2Mzg5NjExNztrdnNzcD1icnhkO2t2c2VjdXJlPXRydWU7a3ZwZ2NvbG89c2czO2t2YWR0YyU1RmR2bWt0bmFtZT11bmtub3duO2t2YWR0YyU1RmR2b3NwbHQ9d2luZG93cyU1RjEwO2t2YWR0YyU1RmR2YnJhbmQ9Z29vZ2xlO2t2YWR0YyU1RmR2dHlwZT1kZXNrdG9wO2t2YWR0YyU1RmR2bW9kZWw9Y2hyb21lJTVGJTJEJTVGd2luZG93cztrdnJlcG8lNUZkdm9zcGx0PXdpbmRvd3MlNUYxMDtrdmFkdGMlNUZkdm9zdmVyc2lvbj1OVCUyMDEwJTJFMDtrdmFkdGMlNUZjcm1jYz1VTktOT1dOO2t2YWR0YyU1RmNybW5jPVVOS05PV047Z2Rwcj0wO2FkY2xudGlkPTEwMDQ7c3BhY2VpZD03OTQyNjAwMTg7XCIgdGFyZ2V0PV90b3A+PGltZyBzcmM9XCJodHRwczpcL1wvYWthLWNkbi5hZHRlY2h1cy5jb21cL2ltYWdlc1wvQVRDb2xsYXBzZS5naWZcIiBib3JkZXI9MCBhbHQ9XCJBT0wgQWRcIiB3aWR0aD1cIjFcIiBoZWlnaHQ9XCIxXCIgPjxcL2E+Jyk7XG4gIFxuPFwvc2NyaXB0PiIsImxvd0hUTUwiOiIiLCJtZXRhIjp7InkiOnsicG9zIjoiUklDSCIsImNzY0hUTUwiOiI8aW1nIHdpZHRoPTEgaGVpZ2h0PTEgYWx0PVwiXCIgc3JjPVwiaHR0cHM6XC9cL2FzLnkuYXR3b2xhLmNvbVwvYWRjb3VudHwyLjB8NTExMy4xfDUwNDMwMzV8MHwwfEFkSWQ9LTQwO0JuSWQ9MDtjdD0xNDUxNzA0MjY2O3N0PTE2Njc7YWRjaWQ9MDtpdGltZT0yMTkxNTMwOTM7cmVxdHlwZT01OzthZGNsbnRpZD0xMDA0O3NwYWNlaWQ9Nzk0MjYwMDE4O2FkcG9zaXRpb249UklDSDtsbXNpZD07cHZpZD1YMERYeGpFd0xqTHFYTE9kdFh1YkFRTXJORE11TWdBQUFBQldocUl5O3NlY3Rpb25pZD07a3ZzZWN1cmUlMkRkYXJsYT0zJTJEMTElMkQxJTdDeXNkJTdDMjtrdm1uPXk5NjM4OTYxMTc7a3Zzc3A9YnJ4ZDtrdnNlY3VyZT10cnVlO2t2cGdjb2xvPXNnMztrdmFkdGMlNUZkdm1rdG5hbWU9dW5rbm93bjtrdmFkdGMlNUZkdm9zcGx0PXdpbmRvd3MlNUYxMDtrdmFkdGMlNUZkdmJyYW5kPWdvb2dsZTtrdmFkdGMlNUZkdnR5cGU9ZGVza3RvcDtrdmFkdGMlNUZkdm1vZGVsPWNocm9tZSU1RiUyRCU1RndpbmRvd3M7a3ZyZXBvJTVGZHZvc3BsdD13aW5kb3dzJTVGMTA7a3ZhZHRjJTVGZHZvc3ZlcnNpb249TlQlMjAxMCUyRTA7a3ZhZHRjJTVGY3JtY2M9VU5LTk9XTjtrdmFkdGMlNUZjcm1uYz1VTktOT1dOO2dkcHI9MDtcIj4iLCJjc2NVUkkiOiJodHRwczpcL1wvYXMueS5hdHdvbGEuY29tXC9hZGNvdW50fDIuMHw1MTEzLjF8NTA0MzAzNXwwfDB8QWRJZD0tNDA7Qm5JZD0wO2N0PTE0NTE3MDQyNjY7c3Q9MTY2NzthZGNpZD0wO2l0aW1lPTIxOTE1MzA5MztyZXF0eXBlPTU7O2FkY2xudGlkPTEwMDQ7c3BhY2VpZD03OTQyNjAwMTg7YWRwb3NpdGlvbj1SSUNIO2xtc2lkPTtwdmlkPVgwRFh4akV3TGpMcVhMT2R0WHViQVFNck5ETXVNZ0FBQUFCV2hxSXk7c2VjdGlvbmlkPTtrdnNlY3VyZSUyRGRhcmxhPTMlMkQxMSUyRDElN0N5c2QlN0MyO2t2bW49eTk2Mzg5NjExNztrdnNzcD1icnhkO2t2c2VjdXJlPXRydWU7a3ZwZ2NvbG89c2czO2t2YWR0YyU1RmR2bWt0bmFtZT11bmtub3duO2t2YWR0YyU1RmR2b3NwbHQ9d2luZG93cyU1RjEwO2t2YWR0YyU1RmR2YnJhbmQ9Z29vZ2xlO2t2YWR0YyU1RmR2dHlwZT1kZXNrdG9wO2t2YWR0YyU1RmR2bW9kZWw9Y2hyb21lJTVGJTJEJTVGd2luZG93cztrdnJlcG8lNUZkdm9zcGx0PXdpbmRvd3MlNUYxMDtrdmFkdGMlNUZkdm9zdmVyc2lvbj1OVCUyMDEwJTJFMDtrdmFkdGMlNUZjcm1jYz1VTktOT1dOO2t2YWR0YyU1RmNybW5jPVVOS05PV047Z2Rwcj0wOyIsImJlaGF2aW9yIjoibm9uX2V4cCIsImFkSUQiOiIxMjM0NTY3IiwibWF0Y2hJRCI6IiMyNiIsImJvb2tJRCI6IiIsInNsb3RJRCI6IjAiLCJzZXJ2ZVR5cGUiOiItMSIsImVyciI6ZmFsc2UsImhhc0V4dGVybmFsIjpmYWxzZSwic3VwcF91Z2MiOiIwIiwicGxhY2VtZW50SUQiOi0xLCJmZGIiOiJ7XCJmZGJfdXJsXCI6IFwiaHR0cDpcL1wvYmVhcC1iYy55YWhvby5jb21cL2FmP2J2PTEuMC4wJmJzPSgxNWlyNDVyNmIoZ2lkJGptVFZRRGs0TGpISGJGc0hVNWpNa2dLa01UQXVOd0FBQUFDbGpwa0ssc3QkMTQwMjUzNzIzMzAyNjkyMixzcnYkMSxzaSQxMzMwMzU1MSxhZHYkMjU5NDE0MjkwMzYsY3QkMjUsbGkkMzIzOTI1MDA1MSxleHAkMTQwMjU0NDQzMzAyNjkyMixjciQ0MTU0OTg0NTUxLHBiaWQkMjUzNzI3MjgxMzMsdiQxLjApKSZhbD0odHlwZSR7dHlwZX0sY21udCR7Y21udH0sc3VibyR7c3Vib30pJnI9MTBcIiwgXCJmZGJfb25cIjogXCIxXCIsIFwiZmRiX2V4cFwiOiBcIjE0MDI1NDQ0MzMwMjZcIiwgXCJmZGJfaW50bFwiOiBcImVuLXVzXCIgLCBcImRcIiA6IFwiMVwiIH0iLCJzZXJ2ZVRpbWUiOi0xLCJpbXBJRCI6IiIsImNyZWF0aXZlSUQiOi0xLCJhZGMiOiJ7XCJsYWJlbFwiOlwiQWRDaG9pY2VzXCIsXCJ1cmxcIjpcImh0dHBzOlxcXC9cXFwvaW5mby55YWhvby5jb21cXFwvcHJpdmFjeVxcXC91c1xcXC95YWhvb1xcXC9yZWxldmFudGFkcy5odG1sXCIsXCJjbG9zZVwiOlwiQ2xvc2VcIixcImNsb3NlQWRcIjpcIkNsb3NlIEFkXCIsXCJzaG93QWRcIjpcIlNob3cgYWRcIixcImNvbGxhcHNlXCI6XCJDb2xsYXBzZVwiLFwiZmRiXCI6XCJJIGRvbid0IGxpa2UgdGhpcyBhZFwiLFwiY29kZVwiOlwiZW4tdXNcIn0iLCJpczNyZCI6MSwiZmFjU3RhdHVzIjp7ImZlZFN0YXR1c0NvZGUiOiIwIiwiZmVkU3RhdHVzTWVzc2FnZSI6ImZlZGVyYXRpb24gaXMgbm90IGNvbmZpZ3VyZWQgZm9yIGFkIHNsb3QifSwidXNlclByb3ZpZGVkRGF0YSI6e30sImZhY1JvdGF0aW9uIjp7fSwic2xvdERhdGEiOnt9LCJzaXplIjoiMXgxIn19LCJjb25mIjp7InciOjEsImgiOjF9fV0sImNvbmYiOnsidXNlWUFDIjowLCJ1c2VQRSI6MSwic2VydmljZVBhdGgiOiIiLCJ4c2VydmljZVBhdGgiOiIiLCJiZWFjb25QYXRoIjoiIiwicmVuZGVyUGF0aCI6IiIsImFsbG93RmlGIjpmYWxzZSwic3JlbmRlclBhdGgiOiJodHRwczpcL1wvcy55aW1nLmNvbVwvcnFcL2RhcmxhXC8zLTExLTFcL2h0bWxcL3Itc2YuaHRtbCIsInJlbmRlckZpbGUiOiJodHRwczpcL1wvcy55aW1nLmNvbVwvcnFcL2RhcmxhXC8zLTExLTFcL2h0bWxcL3Itc2YuaHRtbCIsInNmYnJlbmRlclBhdGgiOiJodHRwczpcL1wvcy55aW1nLmNvbVwvcnFcL2RhcmxhXC8zLTExLTFcL2h0bWxcL3Itc2YuaHRtbCIsIm1zZ1BhdGgiOiJodHRwczpcL1wvZmMueWFob28uY29tXC91bnN1cHBvcnRlZC0xOTQ2Lmh0bWwiLCJjc2NQYXRoIjoiaHR0cHM6XC9cL3MueWltZy5jb21cL3JxXC9kYXJsYVwvMy0xMS0xXC9odG1sXC9yLWNzYy5odG1sIiwicm9vdCI6InNkYXJsYSIsImVkZ2VSb290IjoiaHR0cHM6XC9cL3MueWltZy5jb21cL3JxXC9kYXJsYVwvMy0xMS0xIiwic2VkZ2VSb290IjoiaHR0cHM6XC9cL3MueWltZy5jb21cL3JxXC9kYXJsYVwvMy0xMS0xIiwidmVyc2lvbiI6IjMtMTEtMSIsInRwYlVSSSI6IiIsImhvc3RGaWxlIjoiaHR0cHM6XC9cL3MueWltZy5jb21cL3JxXC9kYXJsYVwvMy0xMS0xXC9qc1wvZy1yLW1pbi5qcyIsImZkYl9sb2NhbGUiOiJXaGF0IGRvbid0IHlvdSBsaWtlIGFib3V0IHRoaXMgYWQ/fEl0J3Mgb2ZmZW5zaXZlfFNvbWV0aGluZyBlbHNlfFRoYW5rIHlvdSBmb3IgaGVscGluZyB1cyBpbXByb3ZlIHlvdXIgWWFob28gZXhwZXJpZW5jZXxJdCdzIG5vdCByZWxldmFudHxJdCdzIGRpc3RyYWN0aW5nfEkgZG9uJ3QgbGlrZSB0aGlzIGFkfFNlbmR8RG9uZXxXaHkgZG8gSSBzZWUgYWRzP3xMZWFybiBtb3JlIGFib3V0IHlvdXIgZmVlZGJhY2sufFdhbnQgYW4gYWQtZnJlZSBpbmJveD8gVXBncmFkZSB0byBZYWhvbyBNYWlsIFBybyF8VXBncmFkZSBOb3ciLCJwb3NpdGlvbnMiOnsiUklDSCI6eyJkZXN0IjoidGd0UklDSCIsImFzeiI6ImZsZXgiLCJpZCI6IlJJQ0giLCJ3IjoxLCJoIjoxfX0sInByb3BlcnR5IjoiIiwiZXZlbnRzIjpbXSwibGFuZyI6ImVuLXVzIiwic3BhY2VJRCI6Ijc5NDI2MDAxOCIsImRlYnVnIjpmYWxzZSwiYXNTdHJpbmciOiJ7XCJ1c2VZQUNcIjowLFwidXNlUEVcIjoxLFwic2VydmljZVBhdGhcIjpcIlwiLFwieHNlcnZpY2VQYXRoXCI6XCJcIixcImJlYWNvblBhdGhcIjpcIlwiLFwicmVuZGVyUGF0aFwiOlwiXCIsXCJhbGxvd0ZpRlwiOmZhbHNlLFwic3JlbmRlclBhdGhcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC8zLTExLTFcXFwvaHRtbFxcXC9yLXNmLmh0bWxcIixcInJlbmRlckZpbGVcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC8zLTExLTFcXFwvaHRtbFxcXC9yLXNmLmh0bWxcIixcInNmYnJlbmRlclBhdGhcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC8zLTExLTFcXFwvaHRtbFxcXC9yLXNmLmh0bWxcIixcIm1zZ1BhdGhcIjpcImh0dHBzOlxcXC9cXFwvZmMueWFob28uY29tXFxcL3Vuc3VwcG9ydGVkLTE5NDYuaHRtbFwiLFwiY3NjUGF0aFwiOlwiaHR0cHM6XFxcL1xcXC9zLnlpbWcuY29tXFxcL3JxXFxcL2RhcmxhXFxcLzMtMTEtMVxcXC9odG1sXFxcL3ItY3NjLmh0bWxcIixcInJvb3RcIjpcInNkYXJsYVwiLFwiZWRnZVJvb3RcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC8zLTExLTFcIixcInNlZGdlUm9vdFwiOlwiaHR0cHM6XFxcL1xcXC9zLnlpbWcuY29tXFxcL3JxXFxcL2RhcmxhXFxcLzMtMTEtMVwiLFwidmVyc2lvblwiOlwiMy0xMS0xXCIsXCJ0cGJVUklcIjpcIlwiLFwiaG9zdEZpbGVcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC8zLTExLTFcXFwvanNcXFwvZy1yLW1pbi5qc1wiLFwiZmRiX2xvY2FsZVwiOlwiV2hhdCBkb24ndCB5b3UgbGlrZSBhYm91dCB0aGlzIGFkP3xJdCdzIG9mZmVuc2l2ZXxTb21ldGhpbmcgZWxzZXxUaGFuayB5b3UgZm9yIGhlbHBpbmcgdXMgaW1wcm92ZSB5b3VyIFlhaG9vIGV4cGVyaWVuY2V8SXQncyBub3QgcmVsZXZhbnR8SXQncyBkaXN0cmFjdGluZ3xJIGRvbid0IGxpa2UgdGhpcyBhZHxTZW5kfERvbmV8V2h5IGRvIEkgc2VlIGFkcz98TGVhcm4gbW9yZSBhYm91dCB5b3VyIGZlZWRiYWNrLnxXYW50IGFuIGFkLWZyZWUgaW5ib3g/IFVwZ3JhZGUgdG8gWWFob28gTWFpbCBQcm8hfFVwZ3JhZGUgTm93XCIsXCJwb3NpdGlvbnNcIjp7XCJSSUNIXCI6e1wiZGVzdFwiOlwidGd0UklDSFwiLFwiYXN6XCI6XCJmbGV4XCIsXCJpZFwiOlwiUklDSFwiLFwid1wiOjEsXCJoXCI6MX19LFwicHJvcGVydHlcIjpcIlwiLFwiZXZlbnRzXCI6W10sXCJsYW5nXCI6XCJlbi11c1wiLFwic3BhY2VJRFwiOlwiNzk0MjYwMDE4XCIsXCJkZWJ1Z1wiOmZhbHNlfSJ9LCJtZXRhIjp7InkiOnsicGFnZUVuZEhUTUwiOiIiLCJwb3NfbGlzdCI6WyJSSUNIIl0sInRyYW5zSUQiOiJkYXJsYV9wcmVmZXRjaF8xNTU3MjE5MTU0MjYzXzE4Mjg0NTg4NDVfMyIsImsyX3VyaSI6IiIsImZhY19ydCI6LTEsInNwYWNlSUQiOiI3OTQyNjAwMTgiLCJsb29rdXBUaW1lIjoyMywicHJvY1RpbWUiOjI0LCJucHYiOjAsInB2aWQiOiJYMERYeGpFd0xqTHFYTE9kdFh1YkFRTXJORE11TWdBQUFBQldocUl5Iiwic2VydmVUaW1lIjotMSwiZXAiOnsic2l0ZS1hdHRyaWJ1dGUiOiIiLCJ0Z3QiOiJfYmxhbmsiLCJzZWN1cmUiOnRydWUsInJlZiI6Imh0dHBzOlwvXC9sb2dpbi55YWhvby5jb21cL2NvbmZpZ1wvbG9naW4/LnNyYz1mcGN0eCZhbXA7LmludGw9aW4mYW1wOy5sYW5nPWVuLUlOIiwiZmlsdGVyIjoibm9fZXhwYW5kYWJsZTtleHBfaWZyYW1lX2V4cGFuZGFibGU7IiwiZGFybGFJRCI6ImRhcmxhX2luc3RhbmNlXzE1NTcyMTkxNTQyNjNfMTUyNDE0NDYwN18yIn0sInB5bSI6eyIuIjoidjAuMC45OzstOyJ9LCJob3N0IjoiIiwiZmlsdGVyZWQiOltdLCJwZSI6IiJ9fX0="));

